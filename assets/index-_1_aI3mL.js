import{b1 as y,aV as R,l as w,b2 as x,b3 as U,F as $,J as n,D as k,E as V,C as t,I as r,B as c,b4 as q,aK as D,ao as K,z as C,v as L,w as E}from"./index-BofSZpyf.js";import{_ as T}from"./vite-CwlbfChV.js";import{t as z}from"./common-MBBv0Unw.js";import{_ as J}from"./Checkbox-DOyge78Q.js";import{_ as A}from"./Input-BE5seNXq.js";import"./Eye-DgZ31vnW.js";const F="/test-admin/assets/login_banner-DEWIJgzw.png",W={toggleRole:u=>y.post("/auth/role/toggle",u),login:u=>y.post("/auth/login",u,{noNeedToken:!0}),getUser:()=>y.get("/user/detail")},j={class:"wh-full flex-col bg-[url(@/assets/images/login-bg.svg)] bg-cover"},G={class:"m-auto max-w-800 min-w-345 f-c-c rounded-8 bg-opacity-20 bg-cover p-12 card-shadow auto-bg"},H=n("div",{class:"hidden w-380 px-20 py-35 md:block"},[n("img",{src:F,class:"w-full",alt:"login_banner"})],-1),M={class:"w-320 flex-col px-20 py-32"},O={class:"f-c-c text-24 text-#6a6a6a font-normal"},P=n("img",{src:T,class:"mr-12 h-50"},null,-1),X=n("i",{class:"i-fe:user mr-12 opacity-20"},null,-1),Y=n("i",{class:"i-fe:lock mr-12 opacity-20"},null,-1),Z={class:"mt-20 flex items-center"},Q=n("i",{class:"i-fe:key mr-12 opacity-20"},null,-1),ee=["src"],se={class:"mt-20 flex items-center"},ie={__name:"index",setup(u){const I=R(),b=L(),d=E(),S="思钱想厚",o=w({username:"",password:""}),_=w(""),m=z(()=>{_.value=`https://mock.apipark.cn/m1/4694765-4346542-default/auth/captcha?${Date.now()}`},500),f=x.get("loginInfo");f&&(o.value.username=f.username||"",o.value.password=f.password||""),m();function B(){o.value.username="admin",o.value.password="123456",p(!0)}const h=U("isRemember",!0),v=w(!1);async function p(i){const{username:e,password:l,captcha:g}=o.value;if(!e||!l)return $message.warning("请输入用户名和密码");if(!i&&!g)return $message.warning("请输入验证码");try{v.value=!0,$message.loading("正在验证，请稍后...",{key:"login"});const{data:a}=await W.login({username:e,password:l.toString(),captcha:g,isQuick:i});h.value?x.set("loginInfo",{username:e,password:l}):x.remove("loginInfo"),N(a)}catch(a){(a==null?void 0:a.code)===10003&&m(),$message.destroy("login"),console.error(a)}v.value=!1}async function N(i={}){I.setToken(i),$message.loading("登录中...",{key:"login"});try{if($message.success("登录成功",{key:"login"}),d.query.redirect){const e=d.query.redirect;delete d.query.redirect,b.push({path:e,query:d.query})}else b.push("/")}catch(e){console.error(e),$message.destroy("login")}}return(i,e)=>{const l=A,g=J,a=K;return C(),$("div",j,[n("div",G,[H,n("div",M,[n("h2",O,[P,k(" "+V(t(S)),1)]),r(l,{value:t(o).username,"onUpdate:value":e[0]||(e[0]=s=>t(o).username=s),autofocus:"",class:"mt-32 h-40 items-center",placeholder:"请输入用户名",maxlength:20},{prefix:c(()=>[X]),_:1},8,["value"]),r(l,{value:t(o).password,"onUpdate:value":e[1]||(e[1]=s=>t(o).password=s),class:"mt-20 h-40 items-center",type:"password","show-password-on":"mousedown",placeholder:"请输入密码",maxlength:20,onKeydown:e[2]||(e[2]=q(s=>p(),["enter"]))},{prefix:c(()=>[Y]),_:1},8,["value"]),n("div",Z,[r(l,{value:t(o).captcha,"onUpdate:value":e[3]||(e[3]=s=>t(o).captcha=s),class:"h-40 items-center",palceholder:"请输入验证码",maxlength:4,onKeydown:e[4]||(e[4]=q(s=>p(),["enter"]))},{prefix:c(()=>[Q]),_:1},8,["value"]),t(_)?(C(),$("img",{key:0,src:t(_),alt:"验证码",height:"40",class:"ml-12 w-80 cursor-pointer",onClick:e[5]||(e[5]=(...s)=>t(m)&&t(m)(...s))},null,8,ee)):D("",!0)]),r(g,{class:"mt-20",checked:t(h),label:"记住我","on-update:checked":s=>h.value=s},null,8,["checked","on-update:checked"]),n("div",se,[r(a,{class:"h-40 flex-1 rounded-5 text-16",type:"primary",ghost:"",onClick:e[6]||(e[6]=s=>B())},{default:c(()=>[k(" 一键体验 ")]),_:1}),r(a,{class:"ml-32 h-40 flex-1 rounded-5 text-16",type:"primary",loading:t(v),onClick:e[7]||(e[7]=s=>p())},{default:c(()=>[k(" 登录 ")]),_:1},8,["loading"])])])])])}}};export{ie as default};
